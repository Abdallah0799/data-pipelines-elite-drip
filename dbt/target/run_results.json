{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2024-08-22T13:38:58.761500Z", "invocation_id": "49174959-9a2a-4eb7-81c5-ffd45df951ea", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:53.117840Z", "completed_at": "2024-08-22T13:38:53.132421Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:53.147329Z", "completed_at": "2024-08-22T13:38:54.477259Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3688671588897705, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "44ba8b76-4fe0-4fab-a956-d5fe801bdc94", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.stg_order_items", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `mycenter-425712`.`fictive_company`.`order_items`\n)\n\nSELECT * FROM source", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`stg_order_items`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:53.120289Z", "completed_at": "2024-08-22T13:38:53.126346Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:53.126845Z", "completed_at": "2024-08-22T13:38:54.478486Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.3691949844360352, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "fffd3647-7b8c-4860-8bb0-351e8085de7b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.stg_orders", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `mycenter-425712`.`fictive_company`.`orders`\n)\n\nSELECT * FROM source", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`stg_orders`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:53.110439Z", "completed_at": "2024-08-22T13:38:53.126629Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:53.145708Z", "completed_at": "2024-08-22T13:38:54.480090Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3733999729156494, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "5dfa241d-9d0f-43ef-b366-8fb1c4ddcc3f", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.stg_charges", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `mycenter-425712`.`fictive_company`.`charges`\n)\n\nSELECT * FROM source", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`stg_charges`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:53.121481Z", "completed_at": "2024-08-22T13:38:53.138933Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:53.148782Z", "completed_at": "2024-08-22T13:38:54.481459Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3717429637908936, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "3044fa0c-ee4e-4b89-b1fd-80f8da8102fb", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.stg_players", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `mycenter-425712`.`fictive_company`.`players`\n)\n\nSELECT * FROM source", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`stg_players`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:54.493440Z", "completed_at": "2024-08-22T13:38:54.497945Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:54.498879Z", "completed_at": "2024-08-22T13:38:55.890293Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4031269550323486, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "de293861-2b42-4cff-93f8-9d4130fadfc4", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.charges", "compiled": true, "compiled_code": "WITH charges AS (\n    SELECT * FROM `mycenter-425712`.`fictive_company_transformation`.`stg_charges`\n)\n\nSELECT * FROM charges", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`charges`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:54.491539Z", "completed_at": "2024-08-22T13:38:54.498442Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:54.500720Z", "completed_at": "2024-08-22T13:38:55.893996Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.4077329635620117, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "e9ea8d18-b1c0-465e-95c0-04710d1f2b12", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.stg_products", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `mycenter-425712`.`fictive_company`.`products`\n)\n\nSELECT * FROM source", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`stg_products`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:54.502781Z", "completed_at": "2024-08-22T13:38:54.512542Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:54.546835Z", "completed_at": "2024-08-22T13:38:55.896511Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.3960890769958496, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "4ec0c182-e8be-44f0-b515-29ad913bfb48", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.ltv_by_first_purchase_monthly_cohort", "compiled": true, "compiled_code": "WITH  __dbt__cte__clients_first_order as (\nWITH orders AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_orders`\n)\n\nSELECT \n    customer_id, \n    MIN(order_date) AS first_order_date\nFROM \n    orders\nGROUP BY \n    customer_id\n), orders AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_orders`\n),\n\nclients_first_order AS (\n    SELECT * \n    FROM __dbt__cte__clients_first_order\n),\n\nCohortMonthlyLTV AS (\n    SELECT \n        FORMAT_DATE('%Y-%m', cfo.first_order_date) AS cohort_month,\n        DATE_DIFF(DATETIME(o.order_date), DATETIME(cfo.first_order_date), MONTH) AS order_month,\n        SUM(o.amount) AS monthly_ltv\n    FROM \n        orders o\n    JOIN \n        clients_first_order cfo \n        ON cfo.customer_id = o.customer_id\n    GROUP BY \n        cohort_month, \n        order_month\n    ORDER BY \n        cohort_month, \n        order_month\n)\n\nSELECT \n    *,\n    SUM(monthly_ltv) OVER (\n        PARTITION BY cohort_month \n        ORDER BY order_month\n    ) AS ltv\nFROM \n    CohortMonthlyLTV\nORDER BY \n    cohort_month, \n    order_month", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`ltv_by_first_purchase_monthly_cohort`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:54.508584Z", "completed_at": "2024-08-22T13:38:54.546547Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:54.578894Z", "completed_at": "2024-08-22T13:38:55.899054Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3970589637756348, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "77323185-d951-4a39-b82f-98fa98b334fd", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.players", "compiled": true, "compiled_code": "WITH  __dbt__cte__clients_first_order as (\nWITH orders AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_orders`\n)\n\nSELECT \n    customer_id, \n    MIN(order_date) AS first_order_date\nFROM \n    orders\nGROUP BY \n    customer_id\n), players AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_players`\n),\n\nclients_first_order AS (\n    SELECT * \n    FROM __dbt__cte__clients_first_order\n)\n\nSELECT \n    p.*, \n    cfo.first_order_date\nFROM \n    players p\nLEFT JOIN \n    clients_first_order cfo \n    ON p.id = cfo.customer_id", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`players`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:55.908661Z", "completed_at": "2024-08-22T13:38:55.917733Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:55.918322Z", "completed_at": "2024-08-22T13:38:57.226179Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3193039894104004, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "85fd8914-bb59-4ec3-b8ae-958b3660730a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.orders", "compiled": true, "compiled_code": "WITH  __dbt__cte__charge_by_order as (\nWITH charges AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_charges`\n)\n\nSELECT \n    order_id, \n    SUM(amount) AS total_charges\nFROM \n    charges\nGROUP BY \n    order_id\n), orders AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_orders`\n),\n\ncharges_by_order AS (\n    SELECT * \n    FROM __dbt__cte__charge_by_order\n)\n\nSELECT \n    orders.*, \n    COALESCE(cbo.total_charges, 0) AS total_charges\nFROM \n    orders\nLEFT JOIN \n    charges_by_order cbo \n    ON orders.id = cbo.order_id", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`orders`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:55.914540Z", "completed_at": "2024-08-22T13:38:55.918021Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:55.919434Z", "completed_at": "2024-08-22T13:38:57.227273Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.319835901260376, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "c002c0e9-834c-44c6-80f9-4ed12ec259ae", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.order_items", "compiled": true, "compiled_code": "WITH orders AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_orders`\n),\n\norder_items AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_order_items`\n),\n\nproducts AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_products`\n),\n\nplayers AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_players`\n)\n\nSELECT \n    orders.*, \n    order_items.* EXCEPT (id, created_at, updated_at),\n    products.* EXCEPT (id, created_at, updated_at),\n    players.* EXCEPT (id, created_at, updated_at)\nFROM \n    order_items\nJOIN \n    orders ON orders.id = order_items.order_id\nJOIN \n    products ON order_items.product_id = products.id\nJOIN \n    players ON players.id = orders.customer_id", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`order_items`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-22T13:38:57.234022Z", "completed_at": "2024-08-22T13:38:57.239500Z"}, {"name": "execute", "started_at": "2024-08-22T13:38:57.240015Z", "completed_at": "2024-08-22T13:38:58.754760Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.521799087524414, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "mycenter-425712", "job_id": "08edba1c-b71c-4f64-b1a1-d3528e9c3996", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_transformation.products", "compiled": true, "compiled_code": "WITH order_items AS (\n    SELECT * \n    FROM `mycenter-425712`.`fictive_company_transformation`.`order_items`\n),\n\nproducts AS (\n    SELECT *\n    FROM `mycenter-425712`.`fictive_company_transformation`.`stg_products`\n)\n\nSELECT\n    products.title AS product_name,\n    SUM(o.quantity) AS total_sales,\n    SUM(o.quantity * products.unit_amount) AS total_revenue,\n    SUM(o.quantity * products.unit_amount) / NULLIF(SUM(o.quantity), 0) AS avg_sale_price,\n    COUNT(DISTINCT o.customer_id) AS total_unique_customers,\n    MIN(o.order_date) AS first_purchase_date\nFROM\n    order_items o\nLEFT JOIN\n    products \n    ON o.product_id = products.id\nGROUP BY\n    products.title", "relation_name": "`mycenter-425712`.`fictive_company_transformation`.`products`"}], "elapsed_time": 6.565251111984253, "args": {"cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "enable_legacy_logger": false, "indirect_selection": "eager", "introspect": true, "which": "run", "strict_mode": false, "log_level": "info", "log_level_file": "debug", "require_resource_names_without_spaces": false, "log_file_max_bytes": 10485760, "static_parser": true, "log_path": "/Users/abdallahgazal/Documents/GitHub/data-pipelines/dbt/logs", "log_format_file": "debug", "project_dir": "/Users/abdallahgazal/Documents/GitHub/data-pipelines/dbt", "version_check": true, "write_json": true, "printer_width": 80, "show_resource_report": false, "favor_state": false, "use_colors": true, "source_freshness_run_project_hooks": false, "profiles_dir": "/Users/abdallahgazal/.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse_file_diff": true, "invocation_command": "dbt run", "quiet": false, "populate_cache": true, "send_anonymous_usage_stats": true, "select": [], "partial_parse": true, "exclude": [], "print": true, "defer": false, "log_format": "default", "vars": {}, "empty": false, "use_colors_file": true, "macro_debugging": false}}